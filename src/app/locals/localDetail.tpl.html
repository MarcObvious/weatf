<div class="local-detail row-fluid clearfix">
    <div back class="local-detail-header" >
        <p><img src="../../assets/mbd_back.svg" width="29px"> Detalles local {{local.id}}</p>
    </div>
    <div class="panel panel-default">
        <div class="panel-body">
            <div ng-if="local" class="col-lg-12">
                <div class="local-detail-title">
                    <h3 class="local-detail-local"> Ficha de {{local.name}}</h3>
                </div>
                <hr>
                <div class="col-lg-6">
                    <p><span>Id: </span>{{local.id}}</p>
                    <p><span>Dirección: </span>{{local.direction}}</p>
                    <p><span>Desde: </span>{{local.from_hour}}</p>
                    <p><span>Latitud: </span>{{local.lat}}</p>
                    <p><span>Longitud: </span>{{local.lng}}</p>
                    <p><span>Nombre: </span>{{local.name}}</p>
                    <p><span>Hora de recogida: </span>{{local.pickup_time}}</p>
                    <p><span>Codigo postal: </span>{{local.postcode}}</p>
                    <p><span>Usuario: </span>{{local.user_id}}</p>
                    <p><span>Actualizado: </span>{{local.updated_at}}</p>
                </div>
                <div class="col-lg-6">
                    <img src="{{local.picture}}" width="100%" height="100%">
                    &nbsp;
                </div>

                <div class="col-lg-12" style="padding: 0">

                    <div class="col-lg-3">
                        <button class="btn btn-warning btn-block" ui-sref="root.orders({id_local:{{local.id}}})"> Ver pedidos  <i class="fa fa-eye"></i></button>
                        &nbsp;
                    </div>
                    <div class="col-lg-3">
                        <button class="btn btn-success btn-block" ng-click="newProduct()"> Añadir producto <i class="fa fa-shopping-cart"></i></button>
                        &nbsp;
                    </div>
                    <div class="col-lg-3">
                        <button class="btn btn-danger btn-block" ng-click="editUser(local.id)"> Editar usuario  <i class="fa fa-user"></i></button>
                        &nbsp;
                    </div>
                    <div class="col-lg-3">
                        <button class="btn btn-danger btn-block" ng-click="editLocal(local)"> Editar local  <i class="fa fa-home"></i></button>
                        &nbsp;
                    </div>
                </div>

                <div ng-if="local===undefined" class="col-lg-12">
                    <div class="local-detail-header">
                        <i>No hay información para ese local</i>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div ng-if="local.products" class="panel panel-default">
        <div class="panel-body">
            <div class="col-lg-12">
                <div class="local-detail-title">
                    <h3 class="local-detail-local"> Productos de {{local.name}}</h3>
                </div>
                <hr>
                <div ng-repeat="(key,product) in local.products">
                    <div class="col-lg-3">
                        <h4>{{product.name}}</h4>
                        <img src="{{product.picture}}" width="100%" height="100%">

                    </div>
                    <div class="col-lg-3">
                        <h4>Información</h4>
                        <p><span>Precio inicial: </span>{{product.previous_price}}€</p>
                        <p><span>Precio final: </span>{{product.final_price}}€</p>
                        <p><span>IVA: </span>{{product.tax_rate}}%</p>
                        <p><span>Tipo:</span> {{product.type}}</p>
                        <p><span>Stock:</span> {{product.stock}}</p>
                    </div>
                    <div class="col-lg-6">
                        <h4>Descripción</h4>
                        <p>{{product.description}}</p>


                    </div>
                    <div class="col-lg-12" style="padding: 0">
                        <div class="col-lg-3 col-lg-push-9">
                            <button class="btn btn-danger btn-block" ng-click="editProduct(product.id)"> Editar producto  <i class="fa fa-shopping-cart"></i></button>
                            &nbsp;
                        </div>
                    </div>
                    <hr ng-if="key < local.products.length-1" class="col-lg-11">
                </div>

            </div>
        </div>
    </div>
    <div ng-if="orders" class="panel panel-default">
        <div class="panel-body">
            <div class="col-lg-12">
                <div class="local-detail-title">
                    <h3 class="local-detail-local"> Pedidos de {{local.name}}</h3>
                </div>
                <hr>
                <div class="hidden-xs hidden-sm">
                    <table ng-table="vm.tableParams" class="table table-striped table-bordered table-hover" show-filter="true">
                        <tr ng-repeat="order in $data track by $index">
                            <td title="'Pedido'" filter="{ id: 'number'}" sortable="'id'">
                                {{order.id}}</td>
                            <td title="'Estado'" filter="{ order_state: 'number'}" sortable="'order_state'">
                                {{order.order_state_name}}</td>
                            <td title="'Usuario'" filter="{ user_id: 'text'}" sortable="'user_id'">
                                {{order.user_id}}</td>
                            <td title="'Fecha creación'" filter="{ created_at: 'text'}" sortable="'created_at'">
                                {{order.created_at}}</td>
                            <td title="'Fecha actualización'" filter="{ updated_at: 'text'}" sortable="'updated_at'">
                                {{order.updated_at}}</td>
                            <td title="'Acciones'" class="text-center">
                                <button class="btn btn-warning btn-xs" uib-tooltip="Ver detalles del pedido" tooltip-placement="left" tooltip-trigger="mouseenter" ng-click="viewOrderDetail($index)">
                                    <i class="fa fa-eye"></i>
                                </button>
                                <button class="btn btn-danger btn-xs" uib-tooltip="Eliminar pedido" tooltip-placement="left" tooltip-trigger="mouseenter" ng-click="cancelOrder({local_id: local.id, order_id: order.id})">
                                    <i class="fa fa-trash-o"></i>
                                </button>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="hidden-md hidden-lg" style="margin-left: -20px;margin-right: -20px;">
                    <table ng-table="vm.tableParams" class="table table-striped table-bordered table-hover" show-filter="true">
                        <tr ng-repeat="order in $data track by $index">
                            <td title="'#P.'" filter="{ id: 'number'}" sortable="'id'">
                                {{order.id}}</td>
                            <td title="'Estado'" filter="{ order_state: 'number'}" sortable="'order_state'">
                                {{order.order_state_name}}</td>
                            <td title="'#U.'" filter="{ user_id: 'text'}" sortable="'user_id'">
                                {{order.user_id}}</td>
                            <td title="'Creación'" filter="{ created_at: 'text'}" sortable="'created_at'">
                                {{order.created_at|limitTo: 9:2}}</td>
                            <td title="'Acc.'" class="text-center">
                                <button class="btn btn-warning btn-xs" uib-tooltip="Ver detalles del pedido" tooltip-placement="left" tooltip-trigger="mouseenter" ng-click="viewOrderDetail($index)">
                                    <i class="fa fa-eye"></i>
                                </button>
                                <button class="btn btn-danger btn-xs" uib-tooltip="Anular pedido" tooltip-placement="left" tooltip-trigger="mouseenter" ng-click="cancelOrder({local_id: local.id, order_id: order.id})">
                                    <i class="fa fa-trash-o"></i>
                                </button>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
